<!DOCTYPE html>
<html lang="en">
<head>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pocketbase/0.21.1/pocketbase.umd.js"></script>
    <title>Enterprise Portal | Pro-Site</title>
</head>
<body class="bg-slate-900 text-white font-sans">
    <div id="app" class="hidden flex h-screen">
        <aside class="w-64 bg-slate-800 border-r border-slate-700 p-8">
            <h1 class="text-xl font-bold text-blue-500 mb-10">PRO-SITE CORE</h1>
            <nav class="space-y-6">
                <a href="#" class="block text-blue-400">Main Dashboard</a>
                <button onclick="logout()" class="block text-red-400 mt-20">Secure Logout</button>
            </nav>
        </aside>

        <main class="flex-1 p-12">
            <h2 class="text-4xl font-extrabold mb-8">Client <span class="text-blue-500">Workspace</span></h2>
            <div class="bg-slate-800 p-8 rounded-2xl border border-slate-700">
                <p class="text-slate-400 uppercase text-xs font-bold mb-2">Authenticated User</p>
                <p id="user-email" class="text-2xl font-mono">Verified Account</p>
            </div>
        </main>
    </div>

    <script>
        // Use the current origin (localhost or your domain)
        const pb = new PocketBase('https://untriturated-alayah-bifurcately.ngrok-free.dev');

        function checkAuth() {
            if (!pb.authStore.isValid) {
                // Not logged in? Go back to login page
                window.location.href = '/';
            } else {
                // Logged in? Show the content
                document.getElementById('app').classList.remove('hidden');
                document.getElementById('user-email').innerText = pb.authStore.model.email;
            }
        }

        function logout() {
            pb.authStore.clear();
            window.location.href = '/';
        }

        // Run check on load
        checkAuth();
async function handleLogin() {
    const email = document.querySelector('input[type="email"]').value;
    const pass = document.querySelector('input[type="password"]').value;
    const btn = document.querySelector('button[onclick="handleLogin()"]');

    btn.innerText = "Authenticating...";
    
    try {
        // This is the core "Expert" function
        const authData = await pb.collection('users').authWithPassword(email, pass);
        window.location.href = '/dashboard.html';
    } catch (err) {
        alert("Access Denied: " + err.message);
        btn.innerText = "Authenticate";
    }
}
    </script>
</body>
</html>
